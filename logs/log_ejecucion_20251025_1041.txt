================================================================================
LOG DE EJECUCIÓN - EJECUCION
Fecha de inicio: 2025-10-25 10:41:24
================================================================================

[2025-10-25 10:41:24] [INFO] ==================================================
[2025-10-25 10:41:24] [INFO] INICIO DEL PROCESO DE EXTRACCIÓN
[2025-10-25 10:41:24] [INFO] ==================================================
[2025-10-25 10:41:24] [INFO] Intentando conectar a MongoDB (localhost:27017)...
[2025-10-25 10:41:24] [INFO] ✅ Conexión exitosa a MongoDB
[2025-10-25 10:41:24] [INFO] Extrayendo colecciones de la base de datos AirbnMexico...
--------------------------------------------------------------------------------
[2025-10-25 10:41:24] [INFO] Consultando colección: Listings
[2025-10-25 10:41:24] [INFO] Ejecutando consulta en Listings...
[2025-10-25 10:41:25] [INFO] Campo '_id' eliminado del DataFrame
[2025-10-25 10:41:25] [INFO] ✅ Consulta exitosa de Listings
[2025-10-25 10:41:25] [INFO]    - Filas: 26,401
[2025-10-25 10:41:25] [INFO]    - Columnas: 79
[2025-10-25 10:41:25] [INFO]    - Memoria utilizada: 88.34 MB
[2025-10-25 10:41:25] [INFO]    - Columnas: ['id', 'listing_url', 'scrape_id', 'last_scraped', 'source', 'name', 'description', 'neighborhood_overview', 'picture_url', 'host_id', 'host_url', 'host_name', 'host_since', 'host_location', 'host_about', 'host_response_time', 'host_response_rate', 'host_acceptance_rate', 'host_is_superhost', 'host_thumbnail_url', 'host_picture_url', 'host_neighbourhood', 'host_listings_count', 'host_total_listings_count', 'host_verifications', 'host_has_profile_pic', 'host_identity_verified', 'neighbourhood', 'neighbourhood_cleansed', 'neighbourhood_group_cleansed', 'latitude', 'longitude', 'property_type', 'room_type', 'accommodates', 'bathrooms', 'bathrooms_text', 'bedrooms', 'beds', 'amenities', 'price', 'minimum_nights', 'maximum_nights', 'minimum_minimum_nights', 'maximum_minimum_nights', 'minimum_maximum_nights', 'maximum_maximum_nights', 'minimum_nights_avg_ntm', 'maximum_nights_avg_ntm', 'calendar_updated', 'has_availability', 'availability_30', 'availability_60', 'availability_90', 'availability_365', 'calendar_last_scraped', 'number_of_reviews', 'number_of_reviews_ltm', 'number_of_reviews_l30d', 'availability_eoy', 'number_of_reviews_ly', 'estimated_occupancy_l365d', 'estimated_revenue_l365d', 'first_review', 'last_review', 'review_scores_rating', 'review_scores_accuracy', 'review_scores_cleanliness', 'review_scores_checkin', 'review_scores_communication', 'review_scores_location', 'review_scores_value', 'license', 'instant_bookable', 'calculated_host_listings_count', 'calculated_host_listings_count_entire_homes', 'calculated_host_listings_count_private_rooms', 'calculated_host_listings_count_shared_rooms', 'reviews_per_month']
--------------------------------------------------------------------------------
[2025-10-25 10:41:25] [INFO] Consultando colección: Reviews
[2025-10-25 10:41:25] [INFO] Ejecutando consulta en Reviews...
[2025-10-25 10:41:45] [INFO] Campo '_id' eliminado del DataFrame
[2025-10-25 10:41:46] [INFO] ✅ Consulta exitosa de Reviews
[2025-10-25 10:41:46] [INFO]    - Filas: 1,388,226
[2025-10-25 10:41:46] [INFO]    - Columnas: 6
[2025-10-25 10:41:46] [INFO]    - Memoria utilizada: 512.60 MB
[2025-10-25 10:41:46] [INFO]    - Columnas: ['listing_id', 'id', 'date', 'reviewer_id', 'reviewer_name', 'comments']
--------------------------------------------------------------------------------
[2025-10-25 10:41:46] [INFO] Consultando colección: Calendar
[2025-10-25 10:41:46] [INFO] Ejecutando consulta en Calendar...
[2025-10-25 10:49:38] [INFO] Campo '_id' eliminado del DataFrame
[2025-10-25 10:49:40] [INFO] ✅ Consulta exitosa de Calendar
[2025-10-25 10:49:40] [INFO]    - Filas: 9,636,365
[2025-10-25 10:49:40] [INFO]    - Columnas: 7
[2025-10-25 10:49:40] [INFO]    - Memoria utilizada: 1203.88 MB
[2025-10-25 10:49:40] [INFO]    - Columnas: ['listing_id', 'date', 'available', 'price', 'adjusted_price', 'minimum_nights', 'maximum_nights']
--------------------------------------------------------------------------------
[2025-10-25 10:49:40] [INFO] Validando datos extraídos...
--------------------------------------------------------------------------------
[2025-10-25 10:49:40] [INFO] RESUMEN DE EXTRACCIÓN:
[2025-10-25 10:49:40] [INFO]   - Listings: 26,401 registros
[2025-10-25 10:49:40] [INFO]   - Reviews: 1,388,226 registros
[2025-10-25 10:49:40] [INFO]   - Calendar: 9,636,365 registros
[2025-10-25 10:49:42] [INFO]   - Memoria total: 1804.82 MB
[2025-10-25 10:49:42] [INFO] Conexión a MongoDB cerrada
[2025-10-25 10:49:42] [INFO] ==================================================
[2025-10-25 10:49:42] [INFO] PROCESO DE EXTRACCIÓN COMPLETADO EXITOSAMENTE
[2025-10-25 10:49:42] [INFO] ==================================================
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] ==================================================
[2025-10-25 10:49:42] [INFO] INICIO DEL PROCESO DE TRANSFORMACIÓN
[2025-10-25 10:49:42] [INFO] ==================================================
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.1. Abstracción de df_host
[2025-10-25 10:49:42] [INFO] Se abstrae el df_host del df_listings
[2025-10-25 10:49:42] [INFO] ✅ df_host - Filas: 11,897, Columnas: 18
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.2. Eliminación de campos no necesarios en df_host
[2025-10-25 10:49:42] [INFO] ✅ df_host - Filas: 11,897, Columnas: 11
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.3. Limpieza del df_host
[2025-10-25 10:49:42] [INFO] Eliminación de host con nombre, verificación y locación null
[2025-10-25 10:49:42] [INFO] Eliminados 2,736 hosts sin información válida
[2025-10-25 10:49:42] [INFO] Transformando campos de fecha a formato estándar
[2025-10-25 10:49:42] [INFO] ✅ df_host - Filas: 9,161, Columnas: 11
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.4. Abstracción de df_verification
[2025-10-25 10:49:42] [INFO] Se abstrae las formas de verificaciones que tiene cada host
[2025-10-25 10:49:42] [INFO] ✅ df_host - Filas: 9,161, Columnas: 10
[2025-10-25 10:49:42] [INFO] ✅ df_verification - Filas: 18,664, Columnas: 3
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.5. Limpieza de df_listings validando con df_host
[2025-10-25 10:49:42] [INFO] Eliminados 6,237 listings sin host válido
[2025-10-25 10:49:42] [INFO] ✅ df_listings - Filas: 20,164, Columnas: 62
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.6. Eliminación de campos redundantes de df_listings
[2025-10-25 10:49:42] [INFO] ✅ df_listings - Columnas: 33
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.7. Limpieza de campos df_listings
[2025-10-25 10:49:42] [INFO] Eliminados 2,138 listings sin reviews
[2025-10-25 10:49:42] [INFO] Transformando campos de fecha a formato estándar
[2025-10-25 10:49:42] [INFO] Eliminados 2,755 listings con reviews antiguas (>1 año)
[2025-10-25 10:49:42] [INFO] Transformando y validando precios
[2025-10-25 10:49:42] [INFO] Eliminados 892 listings con precios inválidos
[2025-10-25 10:49:42] [INFO] Ajustando campos bathrooms_text, bedrooms, beds
[2025-10-25 10:49:42] [INFO] ✅ df_listings - Filas: 14,379, Columnas: 33
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.8. Abstracción de df_amenities_listings
[2025-10-25 10:49:42] [INFO] Se abstrae el df_amenities_listings del df_listings
[2025-10-25 10:49:42] [INFO] Transformando amenities en lista de Python
[2025-10-25 10:49:42] [INFO] 'Explotando' cada amenity para ser asignado uno a uno a su listing
[2025-10-25 10:49:42] [INFO] ✅ df_amenities_listings - Filas: 515,151, Columnas: 2
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.9. Abstracción de df_amenities
[2025-10-25 10:49:42] [INFO] ✅ df_amenities preliminar - Filas: 5,402
[2025-10-25 10:49:42] [INFO] Limpieza de amenities repetidos y calidad de datos
[2025-10-25 10:49:42] [INFO] ✅ df_amenities_p - Filas: 5,402, Columnas: 2
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.10. Transformación de amenities limpios a df_amenities_listings
[2025-10-25 10:49:42] [INFO] Reemplazar amenities con versión limpia y renombrar 'id' a 'listing_id'
[2025-10-25 10:49:42] [INFO] Eliminados 6 amenities no válidos
[2025-10-25 10:49:42] [INFO] ✅ df_amenities_listings - Filas: 515,145, Columnas: 2
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.11. Creación de df_amenities limpio y ajuste con IDs
[2025-10-25 10:49:42] [INFO] Crear df_amenities limpio con amenities_id
[2025-10-25 10:49:42] [INFO] ✅ df_amenities - Filas: 4,902, Columnas: 2
[2025-10-25 10:49:42] [INFO] Reasignar amenities por amenities_id en df_amenities_listings
[2025-10-25 10:49:42] [INFO] ✅ df_amenities_listings - Filas: 515,145, Columnas: 2
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.12. RESUMEN DE TABLAS GENERADAS:
[2025-10-25 10:49:42] [INFO] ✅ df_listings - Filas: 14,379, Columnas: 32
[2025-10-25 10:49:42] [INFO] ✅ df_host - Filas: 9,161, Columnas: 10
[2025-10-25 10:49:42] [INFO] ✅ df_verification - Filas: 18,664, Columnas: 3
[2025-10-25 10:49:42] [INFO] ✅ df_amenities_listings - Filas: 515,145, Columnas: 2
[2025-10-25 10:49:42] [INFO] ✅ df_amenities - Filas: 4,902, Columnas: 2
--------------------------------------------------------------------------------
[2025-10-25 10:49:42] [INFO] 4.13. Limpieza de df_reviews validando con df_listings
[2025-10-25 10:49:42] [INFO] Se limpiará todos los reviews que no tengan un listing válido
[2025-10-25 10:49:43] [INFO] Eliminados 314,312 reviews sin listing válido
[2025-10-25 10:49:43] [INFO] ✅ df_reviews - Filas: 1,073,914, Columnas: 6
--------------------------------------------------------------------------------
[2025-10-25 10:49:43] [INFO] 4.14. Abstracción de df_reviewer
[2025-10-25 10:49:43] [INFO] Se abstrae el df_reviewer del df_reviews
[2025-10-25 10:49:43] [INFO] Limpiando nombres de reviewers (seleccionando el más común por ID)
[2025-10-25 10:49:44] [INFO] Eliminando campo 'reviewer_name' de df_reviews
[2025-10-25 10:49:44] [INFO] Transformando campos de fecha a formato estándar
[2025-10-25 10:49:44] [INFO] ✅ df_reviews - Filas: 1,073,914, Columnas: 5
[2025-10-25 10:49:44] [INFO] ✅ df_reviewer - Filas: 804,912, Columnas: 2
--------------------------------------------------------------------------------
[2025-10-25 10:49:44] [INFO] 4.15. Limpieza de df_calendar validando con df_listings
[2025-10-25 10:49:44] [INFO] Se limpiará todos los registros de calendar que no tengan un listing válido
[2025-10-25 10:49:44] [INFO] Eliminados 4,388,030 registros sin listing válido
[2025-10-25 10:49:44] [INFO] Eliminando campos no necesarios
[2025-10-25 10:49:44] [INFO] Transformando campos de fecha a formato estándar
[2025-10-25 10:49:46] [INFO] ✅ df_calendar - Filas: 5,248,335, Columnas: 3
[2025-10-25 10:49:46] [INFO] ==================================================
[2025-10-25 10:49:46] [INFO] PROCESO DE TRANSFORMACIÓN COMPLETADO EXITOSAMENTE
[2025-10-25 10:49:46] [INFO] ==================================================
--------------------------------------------------------------------------------
[2025-10-25 10:49:47] [INFO] ==================================================
[2025-10-25 10:49:47] [INFO] INICIO DEL PROCESO DE CARGA
[2025-10-25 10:49:47] [INFO] ==================================================
[2025-10-25 10:49:47] [INFO] Intentando conectar a SQL Server...
[2025-10-25 10:49:47] [INFO] Servidor: DESKTOP-Q68QGU3\JUSERVER
[2025-10-25 10:49:47] [INFO] Base de datos: AirbnbMexico
[2025-10-25 10:49:47] [INFO] ✅ Conexión exitosa a SQL Server
--------------------------------------------------------------------------------
[2025-10-25 10:49:47] [INFO] Resumen de tablas a cargar:
[2025-10-25 10:49:47] [INFO]   - host: 9,161 registros, 10 columnas
[2025-10-25 10:49:47] [INFO]   - verification: 18,664 registros, 3 columnas
[2025-10-25 10:49:47] [INFO]   - amenities: 4,902 registros, 2 columnas
[2025-10-25 10:49:47] [INFO]   - reviewer: 804,912 registros, 2 columnas
[2025-10-25 10:49:47] [INFO]   - listings: 14,379 registros, 32 columnas
[2025-10-25 10:49:47] [INFO]   - amenities_listings: 515,145 registros, 2 columnas
[2025-10-25 10:49:47] [INFO]   - reviews: 1,073,914 registros, 5 columnas
[2025-10-25 10:49:47] [INFO]   - calendar: 5,248,335 registros, 3 columnas
--------------------------------------------------------------------------------
[2025-10-25 10:49:47] [INFO] [1/8] Cargando tabla: host
[2025-10-25 10:49:47] [INFO] Iniciando carga de tabla: host
[2025-10-25 10:49:47] [INFO] Registros a cargar: 9,161
[2025-10-25 10:49:47] [INFO] Columnas: 10
[2025-10-25 10:49:47] [INFO] Verificando existencia de tabla [host]...
[2025-10-25 10:49:47] [INFO] Tabla [host] ya existe. Limpiando datos...
[2025-10-25 10:49:47] [INFO] ✅ Tabla [host] limpiada correctamente
[2025-10-25 10:49:47] [INFO] Preparando datos para inserción en [host]...
[2025-10-25 10:49:47] [INFO] Convirtiendo 9,161 filas a formato SQL...
[2025-10-25 10:49:47] [INFO] Insertando datos en [host]...
[2025-10-25 10:49:49] [INFO] ✅ 9,161 filas insertadas en [host] correctamente
[2025-10-25 10:49:49] [INFO] ✅ Tabla host cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:49:49] [INFO] [2/8] Cargando tabla: verification
[2025-10-25 10:49:49] [INFO] Iniciando carga de tabla: verification
[2025-10-25 10:49:49] [INFO] Registros a cargar: 18,664
[2025-10-25 10:49:49] [INFO] Columnas: 3
[2025-10-25 10:49:49] [INFO] Verificando existencia de tabla [verification]...
[2025-10-25 10:49:49] [INFO] Tabla [verification] ya existe. Limpiando datos...
[2025-10-25 10:49:49] [INFO] ✅ Tabla [verification] limpiada correctamente
[2025-10-25 10:49:49] [INFO] Preparando datos para inserción en [verification]...
[2025-10-25 10:49:49] [INFO] Convirtiendo 18,664 filas a formato SQL...
[2025-10-25 10:49:49] [INFO] Insertando datos en [verification]...
[2025-10-25 10:49:51] [INFO] ✅ 18,664 filas insertadas en [verification] correctamente
[2025-10-25 10:49:51] [INFO] ✅ Tabla verification cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:49:51] [INFO] [3/8] Cargando tabla: amenities
[2025-10-25 10:49:51] [INFO] Iniciando carga de tabla: amenities
[2025-10-25 10:49:51] [INFO] Registros a cargar: 4,902
[2025-10-25 10:49:51] [INFO] Columnas: 2
[2025-10-25 10:49:51] [INFO] Verificando existencia de tabla [amenities]...
[2025-10-25 10:49:51] [INFO] Tabla [amenities] ya existe. Limpiando datos...
[2025-10-25 10:49:51] [INFO] ✅ Tabla [amenities] limpiada correctamente
[2025-10-25 10:49:51] [INFO] Preparando datos para inserción en [amenities]...
[2025-10-25 10:49:51] [INFO] Convirtiendo 4,902 filas a formato SQL...
[2025-10-25 10:49:51] [INFO] Insertando datos en [amenities]...
[2025-10-25 10:49:51] [INFO] ✅ 4,902 filas insertadas en [amenities] correctamente
[2025-10-25 10:49:51] [INFO] ✅ Tabla amenities cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:49:51] [INFO] [4/8] Cargando tabla: reviewer
[2025-10-25 10:49:51] [INFO] Iniciando carga de tabla: reviewer
[2025-10-25 10:49:51] [INFO] Registros a cargar: 804,912
[2025-10-25 10:49:51] [INFO] Columnas: 2
[2025-10-25 10:49:51] [INFO] Verificando existencia de tabla [reviewer]...
[2025-10-25 10:49:51] [INFO] Tabla [reviewer] ya existe. Limpiando datos...
[2025-10-25 10:49:51] [INFO] ✅ Tabla [reviewer] limpiada correctamente
[2025-10-25 10:49:51] [INFO] Preparando datos para inserción en [reviewer]...
[2025-10-25 10:49:52] [INFO] Convirtiendo 804,912 filas a formato SQL...
[2025-10-25 10:49:54] [INFO] Insertando datos en [reviewer]...
[2025-10-25 10:50:35] [INFO] ✅ 804,912 filas insertadas en [reviewer] correctamente
[2025-10-25 10:50:35] [INFO] ✅ Tabla reviewer cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:50:35] [INFO] [5/8] Cargando tabla: listings
[2025-10-25 10:50:35] [INFO] Iniciando carga de tabla: listings
[2025-10-25 10:50:35] [INFO] Registros a cargar: 14,379
[2025-10-25 10:50:35] [INFO] Columnas: 32
[2025-10-25 10:50:35] [INFO] Verificando existencia de tabla [listings]...
[2025-10-25 10:50:35] [INFO] Tabla [listings] ya existe. Limpiando datos...
[2025-10-25 10:50:35] [INFO] ✅ Tabla [listings] limpiada correctamente
[2025-10-25 10:50:35] [INFO] Preparando datos para inserción en [listings]...
[2025-10-25 10:50:36] [INFO] Convirtiendo 14,379 filas a formato SQL...
[2025-10-25 10:50:36] [INFO] Insertando datos en [listings]...
[2025-10-25 10:50:51] [INFO] ✅ 14,379 filas insertadas en [listings] correctamente
[2025-10-25 10:50:51] [INFO] ✅ Tabla listings cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:50:51] [INFO] [6/8] Cargando tabla: amenities_listings
[2025-10-25 10:50:51] [INFO] Iniciando carga de tabla: amenities_listings
[2025-10-25 10:50:51] [INFO] Registros a cargar: 515,145
[2025-10-25 10:50:51] [INFO] Columnas: 2
[2025-10-25 10:50:51] [INFO] Verificando existencia de tabla [amenities_listings]...
[2025-10-25 10:50:51] [INFO] Tabla [amenities_listings] ya existe. Limpiando datos...
[2025-10-25 10:50:51] [INFO] ✅ Tabla [amenities_listings] limpiada correctamente
[2025-10-25 10:50:51] [INFO] Preparando datos para inserción en [amenities_listings]...
[2025-10-25 10:50:52] [INFO] Convirtiendo 515,145 filas a formato SQL...
[2025-10-25 10:50:52] [INFO] Insertando datos en [amenities_listings]...
[2025-10-25 10:51:12] [INFO] ✅ 515,145 filas insertadas en [amenities_listings] correctamente
[2025-10-25 10:51:12] [INFO] ✅ Tabla amenities_listings cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:51:12] [INFO] [7/8] Cargando tabla: reviews
[2025-10-25 10:51:12] [INFO] Iniciando carga de tabla: reviews
[2025-10-25 10:51:12] [INFO] Registros a cargar: 1,073,914
[2025-10-25 10:51:12] [INFO] Columnas: 5
[2025-10-25 10:51:12] [INFO] Verificando existencia de tabla [reviews]...
[2025-10-25 10:51:12] [INFO] Tabla [reviews] ya existe. Limpiando datos...
[2025-10-25 10:51:12] [INFO] ✅ Tabla [reviews] limpiada correctamente
[2025-10-25 10:51:12] [INFO] Preparando datos para inserción en [reviews]...
[2025-10-25 10:51:16] [INFO] Convirtiendo 1,073,914 filas a formato SQL...
[2025-10-25 10:51:21] [INFO] Insertando datos en [reviews]...
[2025-10-25 10:52:24] [INFO] ✅ 1,073,914 filas insertadas en [reviews] correctamente
[2025-10-25 10:52:24] [INFO] ✅ Tabla reviews cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:52:24] [INFO] [8/8] Cargando tabla: calendar
[2025-10-25 10:52:24] [INFO] Iniciando carga de tabla: calendar
[2025-10-25 10:52:24] [INFO] Registros a cargar: 5,248,335
[2025-10-25 10:52:24] [INFO] Columnas: 3
[2025-10-25 10:52:24] [INFO] Verificando existencia de tabla [calendar]...
[2025-10-25 10:52:24] [INFO] Tabla [calendar] ya existe. Limpiando datos...
[2025-10-25 10:52:24] [INFO] ✅ Tabla [calendar] limpiada correctamente
[2025-10-25 10:52:24] [INFO] Preparando datos para inserción en [calendar]...
[2025-10-25 10:52:34] [INFO] Convirtiendo 5,248,335 filas a formato SQL...
[2025-10-25 10:52:55] [INFO] Insertando datos en [calendar]...
[2025-10-25 10:58:42] [INFO] ✅ 5,248,335 filas insertadas en [calendar] correctamente
[2025-10-25 10:58:42] [INFO] ✅ Tabla calendar cargada exitosamente
--------------------------------------------------------------------------------
[2025-10-25 10:58:42] [INFO] RESUMEN DE CARGA:
[2025-10-25 10:58:42] [INFO]   - Tablas cargadas: 8
[2025-10-25 10:58:42] [INFO]   - Total de registros: 7,689,412
[2025-10-25 10:58:42] [INFO]   - Base de datos: AirbnbMexico
[2025-10-25 10:58:42] [INFO] Conexión a SQL Server cerrada
[2025-10-25 10:58:42] [INFO] ==================================================
[2025-10-25 10:58:42] [INFO] PROCESO DE CARGA COMPLETADO EXITOSAMENTE
[2025-10-25 10:58:42] [INFO] ==================================================

================================================================================
Fecha de finalización: 2025-10-25 10:58:42
================================================================================
